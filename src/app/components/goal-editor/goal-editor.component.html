<div style="padding-bottom: 20px">
    <h2>Adjust your goals</h2>
    <div class="goal-preview-gallery">
        <ng-container *ngFor="let goal of goals">
            <goal-preview [goal]="goal" (click)="openEditGoalForm(goal)">
                <div class="icon-wrapper">
                    <div (click)="deleteGoal(goal)" class="icon">
                        <fa-icon [icon]="completeIcon"></fa-icon>
                    </div>
                    <div (click)="deleteGoal(goal)" class="icon">
                        <fa-icon [icon]="deleteIcon"></fa-icon>
                    </div>
                </div>
            </goal-preview>
        </ng-container>
    </div>

    <button (click)="openGoalForm()" class="btn add-goal-btn">
        <span class="btn-icon">+</span>
        <span class="label">Add Goal</span>
    </button>
</div>

<hr>

<div style="padding-top: 20px">
    <h2>Add tasks to your goals</h2>
    <ng-container *ngFor="let goal of goals">
        <div
            style="padding:20px; border-radius: 20px; margin: 20px; border: 1px solid #8e44ad; box-shadow: 5px 5px 20px 0px rgba(0, 0, 0, 0.1);">
            <h2>{{goal.name}}</h2>

            <button class="btn add-task-btn" (click)="openAddTaskForm(goal)">
                Add Task
            </button>

            <div style="margin-top: 20px; display: flex; flex-wrap: wrap; align-content: start;">
                <ng-container *ngFor="let task of getDisplayedTasks(goal.tasks)">
                    <task-preview [task]="task" (deleteSubmit)="deleteTask(task, goal)" (click)="openEditTaskForm(goal, task)"></task-preview>
                </ng-container>
            </div>
        </div>
    </ng-container>
</div>

<button (click)="createTodoList()" [disabled]="!validTodoList" class="btn bottom-fixed">
    Create Optimal To-Do List
</button>

<div class="form-popup">
    <ng-container [ngSwitch]="currentGoalForm">
        <task-form *ngSwitchCase="'addTask'" (submitTask)="addTask($event, selectedGoal)" (close)="closeForm()"
            [goal]="selectedGoal">
            <h2>Add a task to your goal <b>{{selectedGoal.name}}</b></h2>
        </task-form>
        <task-form *ngSwitchCase="'editTask'" (submitTask)="editTask($event, selectedGoal)" [goal]="selectedGoal"
            [task]="selectedTask" (close)="closeForm()">
            <h2>Edit task <b>{{selectedTask.name}}</b></h2>
        </task-form>
        <goal-form *ngSwitchCase="'addGoal'" (submitGoal)="addGoal($event)" (close)="closeForm()">
            <h2>Add a new goal</h2>
        </goal-form>
        <goal-form *ngSwitchCase="'editGoal'" [goal]="selectedGoal" (submitGoal)="editGoal($event)"
            (close)="closeForm()">
            <h2>Edit your goal <b>{{selectedGoal.name}}</b></h2>
        </goal-form>
    </ng-container>
</div>
<!--
    <div class="goal-wrapper" id="goal-display" *ngIf="goals.length">
    <ul>
        <li *ngFor="let goal of goals" class="goal-item">
            <div> Goal: <b>{{goal.name}}</b> <br> Value: {{goal.value}}% <br>Time Estimation: {{goal.time_est}} hr
                <br> Deadline: / {{goal.deadline}}
                <div>
                    <div class="icon plus" (click)="openTaskForm(goal)">
                        <div>+</div>
                    </div>
                    <div class="icon plus" (click)="deleteGoal(goal)" id="hoverText">
                        <div>-</div>
                    </div>
                    <div style="cursor:pointer;" (click)="openEditGoalForm(goal)"><img
                            [src]="imageUrls['edit_icon.png']" alt="edit icon" width="20px" height="20px"> </div>
                </div>
                <div *ngIf="goal.tasks !== undefined">
                    <div *ngIf="goal.tasks.length > 0">

                        <div> ------ Tasks ------
                            <ul>
                                <li *ngFor="let task of getDisplayedTasks(goal.tasks)">
                                    <div class="task-item" [ngClass]="{
                      'completed': task.completed, 
                      'scheduled': (task.scheduled || task.completed)
                    }">
                                        {{task.name}} <br /> Time: {{task.time_est}} hr
                                        <br> Deadline: / {{task.deadline}}
                                        <div *ngIf="!(task.scheduled || task.completed)" class="del-wrapper">
                                            <div class="del" (click)="deleteTask(goal, task)">
                                                <div>-</div>
                                            </div>
                                        </div>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </li>
    </ul>
</div>

<button (click)="createTodoList()" [disabled]="!validTodoList" class="btn bottom-fixed">
    Create Optimal To-Do List
</button>

<div class="form-popup">
    <ng-container [ngSwitch]="currentGoalForm">
        <add-task-form *ngSwitchCase="'task'" [goal]="selectedGoal" (submitTask)="addTask($event, selectedGoal)"
            (close)="toggleForm('none')">
        </add-task-form>
        <add-goal-form *ngSwitchCase="'goal'" (submitGoal)="addGoal($event)" (close)="toggleForm('none')">
        </add-goal-form>
        <edit-goal-form *ngSwitchCase="'editGoal'" [goal]="selectedGoal" (submitGoal)="editGoal($event)"
            (close)="toggleForm('none')">
        </edit-goal-form>
    </ng-container>
</div>
-->